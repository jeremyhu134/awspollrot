{% extends 'base.html' %}

{% block content %}
<div class="content-layout">
    <!-- Left: Person's Account Info -->
    <div class="left-section">
        <h2>{{current_user.display_name}}'s Account</h2>
        <!-- Add more user info here if desired -->
        <p><a href="{{ url_for('log_out') }}">Logout</a></p>
    </div>

    <!-- Right: My Polls Scrollable Section -->
    <div class="right-section">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2>My Polls</h2>
            <a href="{{ url_for('create_poll') }}" class="create-button">Create New Poll</a>
        </div>
        <div class="polls-list">
            {% for poll in polls %}
                <div class="question-box">
                    <h2>{{ poll.question }}</h2>
                    {% set total_votes = (poll.votes_a or 0) + (poll.votes_b or 0) + (poll.votes_c or 0) + (poll.votes_d or 0) %}

                    <ul style="list-style-type: none; padding-left: 0;">
                        {% if poll.option_a %}
                            {% set percent_a = ((poll.votes_a or 0) / total_votes * 100) if total_votes > 0 else 0 %}
                            <li>
                                <div class="answer" style="background: linear-gradient(to right, green {{ percent_a }}%, #e1e1e1 {{ percent_a }}%); padding: 5px;">
                                    <strong>A:</strong> {{ poll.option_a }} ({{ percent_a | round(1) }}%)
                                </div>
                            </li>
                        {% endif %}

                        {% if poll.option_b %}
                            {% set percent_b = ((poll.votes_b or 0) / total_votes * 100) if total_votes > 0 else 0 %}
                            <li>
                                <div class="answer" style="background: linear-gradient(to right, green {{ percent_b }}%, #e1e1e1 {{ percent_b }}%); padding: 5px;">
                                    <strong>B:</strong> {{ poll.option_b }} ({{ percent_b | round(1) }}%)
                                </div>
                            </li>
                        {% endif %}

                        {% if poll.option_c %}
                            {% set percent_c = ((poll.votes_c or 0) / total_votes * 100) if total_votes > 0 else 0 %}
                            <li>
                                <div class="answer" style="background: linear-gradient(to right, green {{ percent_c }}%, #e1e1e1 {{ percent_c }}%); padding: 5px;">
                                    <strong>C:</strong> {{ poll.option_c }} ({{ percent_c | round(1) }}%)
                                </div>
                            </li>
                        {% endif %}

                        {% if poll.option_d %}
                            {% set percent_d = ((poll.votes_d or 0) / total_votes * 100) if total_votes > 0 else 0 %}
                            <li>
                                <div class="answer" style="background: linear-gradient(to right, green {{ percent_d }}%, #e1e1e1 {{ percent_d }}%); padding: 5px;">
                                    <strong>D:</strong> {{ poll.option_d }} ({{ percent_d | round(1) }}%)
                                </div>
                            </li>
                        {% endif %}
                    </ul>
                    <p><em>Total votes: {{ total_votes }}</em></p>
                </div>
            {% else %}
                <p>No polls found.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
